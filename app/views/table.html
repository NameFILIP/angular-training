<div class="form-inline filter-form">
  <div class="form-group">
    <label for="filter" class="sr-only">Filter</label>
    <input type="text" id="filter" class="form-control" ng-model="filterField" placeholder="Filter">
  </div>
</div>

<table id="review-accordion" class="table table-bordered table-hover">
  <thead>
    <tr>
      <th><a href="" ng-click="setSortState('name')">Name</a></th>
      <th><a href="" ng-click="setSortState('job')">Job title</a></th>
      <th><a href="" ng-click="setSortState('age')">Age</a></th>
      <th><a href="" ng-click="setSortState('grade')">Grade</a></th>
    </tr>
  </thead>
  <!-- class "panel" is added to make the bootstrap's collapse work -->
  <tbody class="panel">
    <tr data-toggle="collapse" data-parent="#review-accordion" data-target="#review-collapse{{ $index }}" ng-repeat-start="emp in employees | filter:filterField | orderBy:sortState.column:sortState.reverse| pagination:paginationState">
    <!-- $event.stopPropagation() - to not open the reviews pane when clicked on the name -->
      <td><a href="" ng-click="addEmployee(selectedTeam.name, emp); $event.stopPropagation();" employee-details="emp">{{ emp.name }}</a></td>
      <td>{{ emp.job }}</td>
      <td>{{ emp.age }}</td>
      <td>{{ emp.grade }}</td>
    </tr>
    <tr id="review-collapse{{ $index }}" class="collapse" ng-repeat-end>
      <td colspan="4">
        <form role="form" ng-submit="addReview(emp, author, review)">
          <table class="table reviews-table">
            <tfoot>
              <tr>
                <td>
                  <div class="form-group">
                    <label class="sr-only" for="author{{ $index }}">Author</label>
                    <input type="text" id="author{{ $index }}" class="form-control input-sm" ng-model="author" placeholder="Author" required>
                  </div>
                </td>
                <td>
                  <div class="form-group">
                    <label class="sr-only" for="review{{ $index }}">Author</label>
                    <textarea id="review{{ $index }}" class="form-control input-sm" ng-model="review" placeholder="Review" required rows="2"></textarea>
                  </div>
                </td>
                <td>
                  <button type="submit" class="btn btn-default btn-sm">Submit</button>
                </td>
              </tr>
            </tfoot>
            <tbody>
              <tr ng-repeat="rev in emp.reviews">
                <td>{{ rev.author }}</td>
                <td>{{ rev.review }}</td>
                <td>
                  <span class="glyphicon glyphicon-minus" ng-click="removeReview(emp, rev)"></span>
                </td>
              </tr>
            </tbody>
          </table>
        </form>
      </td>
    </tr>
  </tbody>
</table>
<div class="text-center">
  <pagination total-items="paginationState.totalItems" ng-model="paginationState.currentPage" max-size="5" boundary-links="true" items-per-page="paginationState.numPerPage" class="pagination"></pagination>
</div>
